### ğŸ“Œ GIá»šI THIá»†U Äá»€ TÃ€I

Sá»¬ Dá»¤NG ESP8266 ÄO NHIá»†T Äá»˜ , Äá»˜ áº¨M, ÃNH SÃNG, ÄIá»€U KHIá»‚N THIáº¾T Bá»Š THÃ”NG QUA MQTT

### ğŸ“Œ LÃ½ do chá»n Ä‘á» tÃ i

Internet of Things (IoT) lÃ  xu hÆ°á»›ng Ä‘ang Ä‘Æ°á»£c cÃ¡c doanh nghiá»‡p trong lÄ©nh vá»±c cÃ´ng nghá»‡ quan tÃ¢m vÃ  Ä‘áº§u tÆ° nghiÃªn cá»©u. Cuá»™c Ä‘ua IoT Ä‘Ã£ vÃ  Ä‘ang diá»…n ra máº¡nh máº½ giá»¯a cÃ¡c doanh nghiá»‡p trÃªn toÃ n tháº¿ giá»›i. Theo Gartner, Ä‘áº¿n nÄƒm 2020, tháº¿ giá»›i sáº½ cÃ³ khoáº£ng 20 tá»· thiáº¿t bá»‹ sá»­ dá»¥ng IoT, doanh sá»‘ dá»± kiáº¿n trong nÄƒm lÃ  437 tá»· USD. Náº¯m báº¯t Ä‘Æ°á»£c nhu cáº§u Ä‘Ã³ vÃ  káº¿t há»£p yÃªu cáº§u cá»§a mÃ´n há»c nhÃ³m chÃºng em Ä‘Ã£ cho phÃ¡t triá»ƒn má»™t á»©ng dá»¥ng IoT lÃ  má»™t há»‡ thá»‘ng Ä‘iá»u khiá»ƒn giÃ¡m sÃ¡t Ä‘o nhiá»‡t Ä‘á»™, Ä‘á»™ áº©m, Ã¡nh sÃ¡ng.  Há»‡ thá»‘ng Ä‘Æ°á»£c thiáº¿t káº¿ há»£p lÃ½ vá»›i mong muá»‘n Ä‘Æ°á»£c tiáº¿p cáº­n Ä‘áº¿n vá»›i nhiá»u ngÆ°á»i dÃ¹ng nháº¥t cÃ³ thá»ƒ.

### ğŸ“Œ MÃ´ táº£ ná»™i dung Ä‘á» tÃ i

XÃ¢y dá»±ng há»‡ thá»‘ng IOT sá»­ dá»¥ng ESP8266 Ä‘á»ƒ Ä‘o nhiá»‡t Ä‘á»™, Ä‘á»™ áº©m, Ã¡nh sÃ¡ng vá»›i cáº£m biáº¿n DHT11 vÃ  BH1750 thÃ´ng qua mosquitto MQTT Broker, sau Ä‘Ã³ dÃ¹ng MySQL Ä‘á»ƒ lÆ°u giÃ¡ trá»‹ thÃ nh cÆ¡ sá»Ÿ dá»¯ liá»‡u.

### ğŸ“Œ Chá»©c nÄƒng chung cá»§a á»©ng dá»¥ng

Há»‡ thá»‘ng sáº½ nháº­n dá»¯ liá»‡u vá» nhiá»‡t Ä‘á»™, Ä‘á»™ áº©m vÃ  Ã¡nh sÃ¡ng tá»« server gá»­i vá», lÆ°u trá»¯ dá»¯ liá»‡u vÃ o database Ä‘á»“ng thá»i xá»­ lÃ­ dá»¯ liá»‡u Ä‘Ã³ vá»›i cÃ¡c ngÆ°á»¡ng mÃ  ngÆ°á»i dÃ¹ng Ä‘Ã£ thiáº¿t láº­p.

### ğŸ“Œ CÃ¡c thiáº¿t bá»‹ sá»­ dá»¥ng:
1. Vi xá»­ lÃ½ ESP8266
2.  Cáº£m biáº¿n nhiá»‡t Ä‘á»™, Ä‘á»™ áº©m DHT11
3.  Cáº£m biáº¿n Ã¡nh sÃ¡ng BH1750
4.  LED Ä‘Æ¡n
5.  DÃ¢y ná»‘i , ráº¯c cáº¯m

### ğŸ“Œ CÃ¡c cÃ´ng cá»¥ Ä‘Æ°á»£c sá»­ dá»¥ng:
1. Visual Code
2. Pháº§n má»m láº­p trÃ¬nh Arduino
3. Note Pad ++
4. MySQL 8.4
5. Command Prompt

### ğŸ“Œ HÆ°á»›ng Dáº«n CÃ i Äáº·t vÃ  Cháº¡y Dá»± Ãn
1. CÃ i Äáº·t MÃ´i TrÆ°á»ng
   
	1.1. CÃ i Äáº·t Node.js

	Táº£i Node.js tá»« trang web chÃ­nh thá»©c vÃ  cÃ i Ä‘áº·t nÃ³ trÃªn mÃ¡y tÃ­nh.


	1.2. CÃ i Äáº·t MySQL
	
	Táº£i vÃ  cÃ i Ä‘áº·t MySQL tá»« trang web chÃ­nh thá»©c.

	Sau khi cÃ i Ä‘áº·t, táº¡o má»™t cÆ¡ sá»Ÿ dá»¯ liá»‡u vá»›i tÃªn mangcambien.

2. CÃ i Äáº·t ThÆ° Viá»‡n Cáº§n Thiáº¿t

	2.1. Táº¡o dá»± Ã¡n Node.js
   
	Má»Ÿ Terminal (hoáº·c Command Prompt) vÃ  táº¡o má»™t thÆ° má»¥c má»›i cho dá»± Ã¡n:
   
		mkdir iot-project
		cd iot-project

	Khá»Ÿi táº¡o dá»± Ã¡n Node.js
	
 		npm init -y

	2.2. CÃ i Ä‘áº·t cÃ¡c thÆ° viá»‡n:

		npm install express mysql2 mqtt

3. Cáº¥u hÃ¬nh dá»± Ã¡n

   3.1 Táº¡o File Cháº¡y Server

	Táº¡o má»™t file server.js trong thÆ° má»¥c dá»± Ã¡n viáº¿t code.


   3.2. Cáº¥u hÃ¬nh cÆ¡ sá»Ÿ dá»¯ liá»‡u

	 Má»Ÿ MySQL vÃ  táº¡o hai báº£ng trong cÆ¡ sá»Ÿ dá»¯ liá»‡u mangcambien:

			CREATE TABLE datasensor (
    	id INT AUTO_INCREMENT PRIMARY KEY,
    	tem FLOAT,
   		 hum FLOAT,
    	light FLOAT,
    	time TIMESTAMP DEFAULT CURRENT_TIMESTAMP
			);

			CREATE TABLE device_history (
    	id INT AUTO_INCREMENT PRIMARY KEY,
    	device_name VARCHAR(50),
    	state VARCHAR(50),
    	timestamp TIMESTAMP DEFAULT CURRENT_TIMESTAMP
			);

4. CÃ i Ä‘áº·t ESP8266 vá»›i Arudino

	4.1 CÃ i Ä‘áº·t Arudino

	 Táº£i vÃ  cÃ i Ä‘áº·t
	
 		Arduino IDE

  4.2 ThÃªm Board ESP8266


  Má»Ÿ Arduino IDE, vÃ o File -> Preferences, thÃªm vÃ o pháº§n "Additional Board Manager URLs":

	 http://arduino.esp8266.com/stable/package_esp8266com_index.json

 Sau Ä‘Ã³  vÃ o Tools -> Board -> Board Manager, tÃ¬m vÃ  cÃ i Ä‘áº·t board ESP8266.

 4.3 CÃ i Ä‘áº·t cÃ¡c thÆ° viá»‡n cáº§n thiáº¿t

 CÃ i Ä‘áº·t cÃ¡c thÆ° viá»‡n
 
PubSubClient (cho MQTT)
DHT (cho cáº£m biáº¿n DHT11)
BH1750 (cho cáº£m biáº¿n Ã¡nh sÃ¡ng)

4.4 Cáº­p nháº­t thÃ´ng tin káº¿t ná»‘i wifi vÃ  mqtt

Trong mÃ£ nguá»“n cá»§a ESP8266, cáº­p nháº­t thÃ´ng tin káº¿t ná»‘i:

	const char* ssid = "TÃªn_WiFi_Cá»§a_Báº¡n";
	const char* password = "Máº­t_Kháº©u_WiFi_Cá»§a_Báº¡n";
	const char* mqtt_server = "Äá»‹a_Chá»‰_IP_Broker_MQTT";

 5. Cháº¡y Dá»± Ãn

	5.1 Cháº¡y Server Node.js

	Trong Terminal , cháº¡y lá»‡nh sau Ä‘á»ƒ khá»Ÿi Ä‘á»™ng server:

		node server.js

	Server sáº½ cháº¡y trÃªn
		
		http://localhost:5501

	5.2 Táº£i lÃªn ESP8266

	Káº¿t ná»‘i ESP8266 vá»›i mÃ¡y tÃ­nh vÃ  táº£i mÃ£ nguá»“n lÃªn board.

	6. Kiá»ƒm tra hoáº¡t Ä‘á»™ng
    
	Má»Ÿ trÃ¬nh duyá»‡t vÃ  truy cáº­p vÃ o
	 
		http://localhost:5501/sensor
	Ä‘á»ƒ xem dá»¯ liá»‡u cáº£m biáº¿n.

	Truy cáº­p vÃ o
	
 		http://localhost:5501/device_history
	Ä‘á»ƒ xem lá»‹ch sá»­ tráº¡ng thÃ¡i thiáº¿t bá»‹.

### ğŸ“Œ Note:

## ğŸ“š TÃ i liá»‡u tham kháº£o

	 https://hocarm.org/mqtt-client-va-mqtt-broker/
	https://www.proe.vn/nodemcu-esp8266-esp12e


	

   
   

   
